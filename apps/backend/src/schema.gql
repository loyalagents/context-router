# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

input ApplyPreferenceSuggestionInput {
  newValue: JSON
  operation: PreferenceOperation!

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!
  suggestionId: ID!
}

input CreateLocationInput {
  address: String!
  label: String!
  type: LocationType!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

"""The reason a suggestion was filtered out"""
enum FilterReason {
  DUPLICATE_KEY
  MISSING_FIELDS
  NO_CHANGE
  UNKNOWN_SLUG
}

type FilteredSuggestion {
  """Category from the preference catalog"""
  category: String
  confidence: Float!

  """Description from the preference catalog"""
  description: String
  filterDetails: String
  filterReason: FilterReason!
  id: ID!
  newValue: JSON!
  oldValue: JSON
  operation: PreferenceOperation!

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!
  sourceMeta: SourceMeta
  sourceSnippet: String!
  wasCorrected: Boolean!
}

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSON

type Location {
  address: String!
  createdAt: DateTime!
  label: String!
  locationId: ID!
  type: LocationType!
  updatedAt: DateTime!
  userId: String!
}

"""Type of location"""
enum LocationType {
  HOME
  OTHER
  WORK
}

type Mutation {
  """Accept a suggestion, promoting it to ACTIVE"""
  acceptSuggestedPreference(id: ID!): Preference!
  applyPreferenceSuggestions(analysisId: ID!, input: [ApplyPreferenceSuggestionInput!]!): [Preference!]!
  createLocation(data: CreateLocationInput!): Location!
  deleteLocation(locationId: String!): Location!

  """Delete a preference"""
  deletePreference(id: ID!): Preference!

  """Reject a suggestion (prevents future suggestions for this slug)"""
  rejectSuggestedPreference(id: ID!): Boolean!

  """Set an active preference (creates or updates)"""
  setPreference(input: SetPreferenceInput!): Preference!

  """
  Suggest a preference (creates SUGGESTED status). Returns null if skipped.
  """
  suggestPreference(input: SuggestPreferenceInput!): Preference
  updateLocation(data: UpdateLocationInput!, locationId: String!): Location!

  """Update an existing user"""
  updateUser(updateUserInput: UpdateUserInput!): User!
}

type Preference {
  """Category from the preference catalog"""
  category: String

  """Confidence score for inferred preferences (0.0 to 1.0)"""
  confidence: Float
  createdAt: DateTime!

  """Description from the preference catalog"""
  description: String

  """Evidence/provenance metadata"""
  evidence: JSON
  id: ID!
  locationId: String

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!

  """Source: USER, INFERRED, IMPORTED, or SYSTEM"""
  sourceType: SourceType!

  """Status: ACTIVE, SUGGESTED, or REJECTED"""
  status: PreferenceStatus!
  updatedAt: DateTime!
  userId: String!

  """The preference value"""
  value: JSON!
}

"""The type of operation to perform on a preference"""
enum PreferenceOperation {
  CREATE
  UPDATE
}

"""The status of a preference"""
enum PreferenceStatus {
  ACTIVE
  REJECTED
  SUGGESTED
}

type PreferenceSuggestion {
  """Category from the preference catalog"""
  category: String
  confidence: Float!

  """Description from the preference catalog"""
  description: String
  id: ID!
  newValue: JSON!
  oldValue: JSON
  operation: PreferenceOperation!

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!
  sourceMeta: SourceMeta
  sourceSnippet: String!
  wasCorrected: Boolean!
}

type Query {
  """
  Get active preferences. With locationId: merged global + location. Without: global only.
  """
  activePreferences(locationId: ID): [Preference!]!

  """Send a text prompt to Vertex AI and receive a generated response"""
  askVertexAI(message: String!): String!
  location(locationId: String!): Location!
  locations: [Location!]!
  locationsByType(type: LocationType!): [Location!]!

  """Get current authenticated user"""
  me: User!

  """Get a single preference by ID"""
  preference(id: ID!): Preference!

  """
  Get suggested preferences (inbox). With locationId: union of global + location. Without: global only.
  """
  suggestedPreferences(locationId: ID): [Preference!]!

  """Get a user by ID"""
  user(id: ID!): User!
}

input SetPreferenceInput {
  """Optional location ID for location-scoped preferences"""
  locationId: String

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!

  """The preference value (type depends on slug definition)"""
  value: JSON!
}

type SourceMeta {
  filename: String
  line: Float
  page: Float
}

"""The source/origin of a preference"""
enum SourceType {
  IMPORTED
  INFERRED
  SYSTEM
  USER
}

input SuggestPreferenceInput {
  """Confidence score for the suggestion (0.0 to 1.0)"""
  confidence: Float!

  """Evidence/provenance for the suggestion (messageIds, snippets, etc.)"""
  evidence: JSON

  """Optional location ID for location-scoped preferences"""
  locationId: String

  """The preference slug (e.g., "food.dietary_restrictions")"""
  slug: String!

  """The suggested preference value"""
  value: JSON!
}

input UpdateLocationInput {
  address: String
  label: String
  type: LocationType
}

input UpdateUserInput {
  email: String
  firstName: String
  lastName: String
  userId: ID!
}

type User {
  createdAt: DateTime!
  email: String!
  firstName: String!
  lastName: String!
  updatedAt: DateTime!
  userId: ID!
}